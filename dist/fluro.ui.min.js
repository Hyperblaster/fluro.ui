angular.module("fluro.ui",["fluro.config","fluro.util"]),angular.module("fluro.ui").directive("fluroImage",function(){return{restrict:"EA",replace:!0,template:'<div class="fluro-image"><img ng-style="styles" ng-src="{{url}}" spinner-on-load/></div>',controller:"InlineImageController",scope:{id:"=fluroImage",imageWidth:"=",imageHeight:"=",ngParams:"&"}}}).controller("InlineImageController",function($scope,$window,Fluro){$scope.params=$scope.ngParams(),$scope.params||($scope.params={}),$scope.styles={},$scope.params.width&&($scope.styles.width=$scope.params.width),$scope.params.height&&($scope.styles.height=$scope.params.height),$scope.params.maxWidth&&($scope.styles["max-width"]=$scope.params.maxWidth),$scope.params.maxHeight&&($scope.styles["max-height"]=$scope.params.maxHeight),$scope.imageWidth&&($scope.params.imageWidth=$scope.imageWidth),$scope.imageHeight&&($scope.params.imageHeight=$scope.imageHeight);var urlString=Fluro.apiURL+"/get/"+$scope.id;if($scope.params.imageWidth||$scope.params.imageHeight)urlString+="?dimensions",$scope.params.imageWidth&&(urlString+="&w="+$scope.params.imageWidth),$scope.params.imageHeight&&(urlString+="&h="+$scope.params.imageHeight);else{var limit=1200;$window.screen.width<=768&&(limit=768),urlString+="?dimensions&w="+limit}$scope.url=urlString}).directive("spinnerOnLoad",function(){return{restrict:"A",link:function(scope,element){var preloader=angular.element('<span class="image-preloader"><i class="fa fa-spinner fa-spin"></i></span>');element.on("load",function(){element.removeClass("spinner-hide"),element.addClass("spinner-show"),preloader.remove()}),scope.$watch("ngSrc",function(){element.addClass("spinner-hide"),element.parent().append(preloader)})}}}),angular.module("fluro.ui").directive("fluroSlideshow",function(){return{restrict:"EA",replace:!0,templateUrl:"fluro/ui/slideshow.html",transclude:!0,require:"fluroSlideshow",controller:"FluroSlideshowController",link:function($scope,$element,$attributes){$scope.$element=$element}}}).controller("FluroSlideshowController",function($scope,Playlist){var _this=this;$scope.playlist=new Playlist,$scope.next=$scope.playlist.next,$scope.previous=$scope.playlist.previous,$scope.select=$scope.playlist.select,$scope.selectIndex=function(index){$scope.playlist.index=index},$scope.$watch("playlist.currentItem",function(newSlide,oldSlide){oldSlide!=newSlide&&(oldSlide&&(oldSlide.active=!1),newSlide&&(newSlide.active=!0))}),console.log("PLAYLISt",$scope.playlist.currentItem),_this.addSlide=function(slide){$scope.playlist.addItem(slide),slide==$scope.playlist.currentItem&&(slide.active=!0)},_this.removeSlide=function(slide){$scope.playlist.removeItem(slide)}}).directive("fluroSlide",function(){return{require:"^fluroSlideshow",restrict:"EA",transclude:!0,replace:!0,templateUrl:"fluro/ui/slide.html",scope:{active:"=?"},link:function(scope,element,attrs,slideshowController){slideshowController.addSlide(scope)}}}),angular.module("fluro.ui").directive("fluroGallery",function(){return{restrict:"E",replace:!0,templateUrl:"fluro/ui/gallery.html",scope:{model:"=ngModel"},controller:"FluroGalleryController",link:function($scope,$element,$attributes){$scope.$element=$element}}}).controller("FluroGalleryController",function($scope,Playlist){$scope.playlist=new Playlist,$scope.playlist.items=$scope.model,$scope.isActive=function(image){return $scope.playlist.currentItem==image},$scope.next=$scope.playlist.next,$scope.previous=$scope.playlist.previous,$scope.select=$scope.playlist.select,$scope.selectIndex=function(index){$scope.playlist.index=index}}),angular.module("fluro.ui").directive("fluroNotifications",function(){return{restrict:"EA",transclude:!0,replace:!0,controller:"FluroNotificationsController",template:'<div class="notifications"><div class="notification animate {{message.type}}" ng-repeat="message in messages"><i class="fa fa-{{message.type}}"></i><span>{{message.text}}</span><i class="close fa fa-times" ng-click="message.remove()"></i></div></div>'}}).controller("FluroNotificationsController",function($scope,Notifications){$scope.messages=Notifications.list}).service("Notifications",function($timeout){var controller={list:[]};return controller.warning=function(text,delay){controller.post(text,"warning",delay)},controller.error=function(text,delay){controller.post(text,"error",delay)},controller.status=function(text,delay){controller.post(text,"status",delay)},controller.post=function(text,type,delay){"undefined"==typeof type&&(type="status"),"undefined"==typeof delay&&(delay=5e3);var msg={};msg.text=text,msg.type=type,msg.remove=function(){var i=controller.list.indexOf(msg);i!=-1&&controller.list.splice(i,1)},controller.list.push(msg),$timeout(msg.remove,delay)},controller}),angular.module("fluro.ui").directive("slider",function(){return{restrict:"EA",transclude:!0,replace:!0,template:'<div class="slider"><div class="slider-contents" ng-transclude></div></div>'}}),angular.module("fluro.ui").run(["$templateCache",function($templateCache){"use strict";$templateCache.put("fluro/ui/columns.html",'<div class=columns><div class="outer cf"><div class=wrapper><div class=column-{{columnWidth}} ng-repeat="item in model"><render ng-model=item></render></div></div></div></div>'),$templateCache.put("fluro/ui/countdown.html",""),$templateCache.put("fluro/ui/gallery.html",'<div class=gallery><div class=outer><div class=wrapper><div class=slideshow ng-swipe-right=previous() ng-swipe-left=next()><div class=slideshow-contents><div class="gallery-slide slide animated" ng-class={active:isActive(image)} ng-repeat="image in model"><img fluro-image=image._id alt={{image.title}} image-height="1200"></div></div><div class=slideshow-controls ng-if="playlist.length > 1"><div class=slideshow-controls-wrapper><a class="slideshow-control slideshow-previous" ng-click=previous()><i class="fa fa-chevron-left"></i></a> <a class="slideshow-control slideshow-next" ng-click=next()><i class="fa fa-chevron-right"></i></a></div></div><div class=slideshow-nav ng-if="playlist.length > 1"><a ng-click=select(item) ng-repeat="item in playlist.items" ng-class={active:isActive(item)}><i class=fa ng-class="{\'fa-circle-o\':!isActive(item), \'fa-circle\':isActive(item)}"></i></a></div></div><div class=gallery-thumbs><slider><div class=gallery-thumb ng-class={active:isActive(image)} ng-click=playlist.select(image) ng-repeat="image in model"><img fluro-image=image._id alt={{image.title}} image-height="150"></div></slider></div></div></div></div>'),$templateCache.put("fluro/ui/slide.html",'<div class="slide animated" ng-class="{\'active\':active}" ng-transclude></div>'),$templateCache.put("fluro/ui/slideshow.html",'<div class=slideshow ng-swipe-right=previous() ng-swipe-left=next()><div class=slideshow-contents ng-transclude></div><div class=slideshow-nav ng-if="playlist.length > 1"><a class="slideshow-control slideshow-previous" ng-click=previous()><i class="fa fa-chevron-left"></i></a> <a ng-click=select(item) ng-repeat="item in playlist.items" ng-class={active:item.active}><i class=fa ng-class="{\'fa-circle-o\':!item.active, \'fa-circle\':item.active}"></i></a> <a class="slideshow-control slideshow-next" ng-click=next()><i class="fa fa-chevron-right"></i></a></div></div>')}]);